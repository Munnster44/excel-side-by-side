
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Excel Side-by-Side Viewer v3.3.3-r3 (GitHub Pages Edition)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f4f4f4; }
    header { background: #003366; color: #fff; text-align: center; padding: 12px 0; font-size: 1.4em; }
    #content { padding: 20px; }
    input[type=file] { margin: 10px 0; display: block; }
    table { border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 4px 8px; }
    footer.app-footer-centered {
      position: fixed; left: 0; right: 0; bottom: 0;
      text-align: center; font-size: 12px; color: #666;
      opacity: 0.9; padding: 6px 8px; pointer-events: none;
    }
  </style>
</head>
<body>
  <header>Excel Side-by-Side Viewer v3.3.3-r3</header>
  <div id="content">
    <p>Select two Excel files to compare:</p>
    <input type="file" id="file1" accept=".xlsx,.xls" />
    <input type="file" id="file2" accept=".xlsx,.xls" />
    <div id="viewer"></div>
  </div>

  <script src="xlsx.full.min.js"></script>
  <script>
    const viewer = document.getElementById('viewer');
    const fileInputs = [document.getElementById('file1'), document.getElementById('file2')];
    let workbooks = [];

    function handleFile(index, file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const wb = XLSX.read(data, { type: 'array' });
        workbooks[index] = wb;
        if (workbooks[0] && workbooks[1]) compareWorkbooks();
      };
      reader.readAsArrayBuffer(file);
    }

    fileInputs.forEach((input, idx) => {
      input.addEventListener('change', e => {
        const file = e.target.files[0];
        if (file) handleFile(idx, file);
      });
    });

    function compareWorkbooks() {
      const sheet1 = workbooks[0].Sheets[workbooks[0].SheetNames[0]];
      const sheet2 = workbooks[1].Sheets[workbooks[1].SheetNames[0]];
      const data1 = XLSX.utils.sheet_to_json(sheet1, { header: 1 });
      const data2 = XLSX.utils.sheet_to_json(sheet2, { header: 1 });
      const maxRows = Math.max(data1.length, data2.length);
      let html = "<table><tr><th colspan='2'>File 1</th><th colspan='2'>File 2</th></tr>";
      for (let i = 0; i < maxRows; i++) {
        const row1 = data1[i] || [];
        const row2 = data2[i] || [];
        const maxCols = Math.max(row1.length, row2.length);
        html += "<tr>";
        for (let j = 0; j < maxCols; j++) {
          const v1 = row1[j] || "";
          const v2 = row2[j] || "";
          const diff = v1 !== v2 ? " style='background:#ffcccc'" : "";
          html += `<td${diff}>${v1}</td><td${diff}>${v2}</td>`;
        }
        html += "</tr>";
      }
      html += "</table>";
      viewer.innerHTML = html;
    }
  </script>

  <footer class="app-footer-centered">
    Excel Side-by-Side Viewer v3.3.3‑r3 © 2025 Glen Carruthers
  </footer>
</body>
</html>

